Sub ColorTokensFromPrefix()
    Dim para As Paragraph
    Dim rng As Range
    Dim txt As String
    Dim pos As Long, startPos As Long, endPos As Long
    Dim token As String, firstChar As String
    
    ' Example text
    txt = "[name][D:division][K:kci][R:risk][A:as]"
    
    ' Insert text in document
    Set para = ActiveDocument.Content.Paragraphs.Add
    para.Range.Text = txt
    
    ' Work on the paragraph range
    Set rng = para.Range
    rng.Font.Color = wdColorBlack ' default black
    
    ' Loop through tokens
    pos = 1
    Do While InStr(pos, rng.Text, "[") > 0
        startPos = InStr(pos, rng.Text, "[")
        endPos = InStr(startPos, rng.Text, "]")
        
        If endPos > startPos Then
            token = Mid(rng.Text, startPos, endPos - startPos + 1)
            
            If Len(token) > 2 Then
                firstChar = Mid(token, 2, 1) ' character after [
                
                ' Apply color based on prefix
                Select Case UCase(firstChar)
                    Case "D" ' Division
                        rng.Characters(startPos).Duplicate.Characters(1).Text = rng.Characters(startPos).Text
                        rng.Characters(startPos, Len(token)).Font.Color = wdColorRed
                    Case "K" ' KCI
                        rng.Characters(startPos, Len(token)).Font.Color = wdColorOrange
                    Case "R" ' Risk
                        rng.Characters(startPos, Len(token)).Font.Color = wdColorBlue
                    Case "A" ' Audit Strategy
                        rng.Characters(startPos, Len(token)).Font.Color = wdColorGreen
                End Select
            End If
        End If
        
        pos = endPos + 1
    Loop
End Sub
